#pragma once
#include "VectorHelper.h"

namespace vec {

template<typename T, size_t N>
FORCEINLINE T dot(const floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	T sum = T{};
	for (size_t i = 0; i < N; ++i) {
		auto tmp = lhs[i] * rhs[i];
		sum += tmp;
	}
	return sum;
}

template<typename T, size_t N>
FORCEINLINE T length(const floatHelper<T, N> &vec) {
	return std::sqrt(lengthSqr(vec));
}

template<typename T, size_t N>
T lengthSqr(const floatHelper<T, N> &vec) {
	return dot(vec, vec);
}

template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> normalize(const floatHelper<T, N> &vec) {
	auto res = vec;
	T len = length(vec);
	res /= len;
	return res;
}

template<typename T, size_t N>
std::ostream &operator<<(std::ostream &os, const floatHelper<T, N> &vec) {
	os << '(';
	for (size_t i = 0; i < N; ++i)
		os << ' ' << vec[i];
	os << " )";
	return os;
}

/*----------------------------- add --------------------------------*/
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator+(const floatHelper<T, N> &lhs, T1 rhs) {
	auto res = lhs;
	res += rhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator+(T1 lhs, const floatHelper<T, N> &rhs) {
	auto res = rhs;
	res += lhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> &operator+=(floatHelper<T, N> &lhs, T1 rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] += rhs;
	return lhs;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> operator+(const floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	auto res = lhs;
	res += rhs;
	return res;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> &operator+=(floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] += rhs[i];
	return lhs;
}
/*----------------------------- add --------------------------------*/
/*----------------------------- sub --------------------------------*/
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator-(const floatHelper<T, N> &lhs, T1 rhs) {
	auto res = lhs;
	res -= rhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator-(T1 lhs, const floatHelper<T, N> &rhs) {
	auto res = rhs;
	res -= lhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> &operator-=(floatHelper<T, N> &lhs, T1 rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] -= rhs;
	return lhs;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> operator-(const floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	auto res = lhs;
	res -= rhs;
	return res;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> &operator-=(floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] -= rhs[i];
	return lhs;
}
/*----------------------------- sub --------------------------------*/
/*----------------------------- mul --------------------------------*/
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator*(const floatHelper<T, N> &lhs, T1 rhs) {
	auto res = lhs;
	res *= rhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator*(T1 lhs, const floatHelper<T, N> &rhs) {
	auto res = rhs;
	res *= lhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> &operator*=(floatHelper<T, N> &lhs, T1 rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] *= rhs;
	return lhs;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> operator*(const floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	auto res = lhs;
	res *= rhs;
	return res;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> &operator*=(floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] *= rhs[i];
	return lhs;
}
/*----------------------------- mul --------------------------------*/
/*----------------------------- div --------------------------------*/
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator/(const floatHelper<T, N> &lhs, T1 rhs) {
	auto res = lhs;
	res /= rhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> operator/(T1 lhs, const floatHelper<T, N> &rhs) {
	auto res = rhs;
	res /= lhs;
	return res;
}
template<typename T, size_t N, typename T1> requires(std::is_convertible_v<T1, T>)
FORCEINLINE floatHelper<T, N> &operator/=(floatHelper<T, N> &lhs, T1 rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] /= rhs;
	return lhs;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> operator/(const floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	auto res = lhs;
	res /= rhs;
	return res;
}
template<typename T, size_t N>
FORCEINLINE floatHelper<T, N> &operator/=(floatHelper<T, N> &lhs, const floatHelper<T, N> &rhs) {
	for (size_t i = 0; i < N; ++i)
		lhs[i] /= rhs[i];
	return lhs;
}
/*----------------------------- div --------------------------------*/

}